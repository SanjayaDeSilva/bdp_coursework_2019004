{"paragraphs":[{"text":"%pyspark\n\n# Load csv to the spark datafarme\ndf = spark.read.csv(\"/data/listings.csv\", header=\"true\", inferSchema=\"true\")\n# show first 5 rec\ndf.head(5)","user":"anonymous","dateUpdated":"2020-01-10T11:56:38+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Row(id=u'49091', name=u'COZICOMFORT LONG TERM STAY ROOM 2', host_id=u'266763', host_name=u'Francesca', neighbourhood_group=u'North Region', neighbourhood=u'Woodlands', latitude=1.44255, longitude=u'103.7958', room_type=u'Private room', price=83, minimum_nights=180, number_of_reviews=u'1', last_review=u'2013-10-21', reviews_per_month=0.01, calculated_host_listings_count=2, availability_365=365),\n Row(id=u'50646', name=u'Pleasant Room along Bukit Timah', host_id=u'227796', host_name=u'Sujatha', neighbourhood_group=u'Central Region', neighbourhood=u'Bukit Timah', latitude=1.33235, longitude=u'103.78521', room_type=u'Private room', price=81, minimum_nights=90, number_of_reviews=u'18', last_review=u'2014-12-26', reviews_per_month=0.28, calculated_host_listings_count=1, availability_365=365),\n Row(id=u'56334', name=u'COZICOMFORT', host_id=u'266763', host_name=u'Francesca', neighbourhood_group=u'North Region', neighbourhood=u'Woodlands', latitude=1.44246, longitude=u'103.79667', room_type=u'Private room', price=69, minimum_nights=6, number_of_reviews=u'20', last_review=u'2015-10-01', reviews_per_month=0.2, calculated_host_listings_count=2, availability_365=365),\n Row(id=u'71609', name=u'Ensuite Room (Room 1 & 2) near EXPO', host_id=u'367042', host_name=u'Belinda', neighbourhood_group=u'East Region', neighbourhood=u'Tampines', latitude=1.34541, longitude=u'103.95712', room_type=u'Private room', price=206, minimum_nights=1, number_of_reviews=u'14', last_review=u'2019-08-11', reviews_per_month=0.15, calculated_host_listings_count=9, availability_365=353),\n Row(id=u'71896', name=u'B&B  Room 1 near Airport & EXPO', host_id=u'367042', host_name=u'Belinda', neighbourhood_group=u'East Region', neighbourhood=u'Tampines', latitude=1.34567, longitude=u'103.95963', room_type=u'Private room', price=94, minimum_nights=1, number_of_reviews=u'22', last_review=u'2019-07-28', reviews_per_month=0.22, calculated_host_listings_count=9, availability_365=355)]"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=625","http://172.17.0.3:4040/jobs/job?id=626","http://172.17.0.3:4040/jobs/job?id=627"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517297_263841567","id":"20200101-165626_311627919","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:38+0000","dateFinished":"2020-01-10T11:56:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4245"},{"text":"%pyspark\n\n#get datatypes\ndf.dtypes\n","user":"anonymous","dateUpdated":"2020-01-10T11:56:38+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('id', 'string'),\n ('name', 'string'),\n ('host_id', 'string'),\n ('host_name', 'string'),\n ('neighbourhood_group', 'string'),\n ('neighbourhood', 'string'),\n ('latitude', 'double'),\n ('longitude', 'string'),\n ('room_type', 'string'),\n ('price', 'int'),\n ('minimum_nights', 'int'),\n ('number_of_reviews', 'string'),\n ('last_review', 'string'),\n ('reviews_per_month', 'double'),\n ('calculated_host_listings_count', 'int'),\n ('availability_365', 'int')]"}]},"apps":[],"jobName":"paragraph_1578642517303_1347495512","id":"20200101-170127_1199547672","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:39+0000","dateFinished":"2020-01-10T11:56:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4246"},{"text":"%pyspark\n\n#2.3 \n#1. Percentage of owners who rent more than one property.\n\nfrom pyspark.sql import *\n\n#DF as a SQL tem view\ndf.createOrReplaceTempView(\"listing_temp_tbl\")\n#df.show()\n#Fetch the count of tot owners \nowners = spark.sql(\"select host_id, host_name, COUNT(*) as Properties from listing_temp_tbl group by host_id, host_name Order by Properties DESC\")\nOwnersCount=owners.count()\n\n\n# Getting the count of tot no of multiple property owners \nownersgtone = spark.sql(\"select host_id, host_name, COUNT(*) as Properties from listing_temp_tbl group by host_id, host_name HAVING Properties>1 Order by Properties DESC\")\nownersgtone_1=ownersgtone.count()\npercentageOfMultipleOwners = (float(ownersgtone_1)/OwnersCount)*100.0\nprint(\"***Percentage of owners who rent more than one property***\")\nprint(percentageOfMultipleOwners)","user":"anonymous","dateUpdated":"2020-01-10T11:56:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"***Percentage of owners who rent more than one property***\n27.3163528977\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=628","http://172.17.0.3:4040/jobs/job?id=629","http://172.17.0.3:4040/jobs/job?id=630","http://172.17.0.3:4040/jobs/job?id=631"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517303_-102980173","id":"20200101-173710_1824268618","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:39+0000","dateFinished":"2020-01-10T11:56:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4247"},{"text":"%pyspark\n#2.3 \n#2. Histogram of number of rentals reviewed over time (based on last_review) in mouth granularity.\nimport pandas as pd \nfrom pyspark.sql.functions import *\nhistogramdf = spark.sql(\"Select month(last_review)month  ,count(*)as sum from listing_temp_tbl where month(last_review) is not null group by month order by month\")\nprint(histogramdf.show())\n\nhistogramdfpandas = histogramdf.toPandas()\nhistPlot = histogramdfpandas.plot.bar(x='month', y='sum', color='orange')\n","user":"anonymous","dateUpdated":"2020-01-10T11:56:41+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+----+\n|month| sum|\n+-----+----+\n|    1| 241|\n|    2| 236|\n|    3| 235|\n|    4| 249|\n|    5| 334|\n|    6| 455|\n|    7| 983|\n|    8|1822|\n|    9| 149|\n|   10| 125|\n|   11| 111|\n|   12| 201|\n+-----+----+\n\nNone\n<matplotlib.figure.Figure at 0x7fcd4051b0d0>\n"},{"type":"IMG","data":"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\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=632","http://172.17.0.3:4040/jobs/job?id=633","http://172.17.0.3:4040/jobs/job?id=634"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578653943969_337319018","id":"20200110-105903_1982355018","dateCreated":"2020-01-10T10:59:03+0000","dateStarted":"2020-01-10T11:56:41+0000","dateFinished":"2020-01-10T11:56:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4248"},{"text":"%pyspark\n\n#2.3 \n#3. Number of rentals that are available all 365 days of the year for each neighbourhood, that are in the neighbourhood which have top 5 average rental prices.\ntop5Arentals = spark.sql(\"Select * from listing_temp_tbl  where  cast(availability_365 as string)like '%365%'\")\ntop5Arentals.createOrReplaceTempView(\"listingtemptable_365\")\ndf1=spark.sql(\" select * from listingtemptable_365 \")\n#df1.show()\ntop5Arentals1 = spark.sql(\"Select neighbourhood_group, neighbourhood, count(*) as count from listingtemptable_365 where neighbourhood in (Select neighbourhood  From listingtemptable_365 Group By neighbourhood_group, neighbourhood  order By avg(price) Limit 5)  group by neighbourhood_group, neighbourhood\")\n\ntop5Arentals1.show()\n","user":"anonymous","dateUpdated":"2020-01-10T11:56:43+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+--------------------+-----+\n|neighbourhood_group|       neighbourhood|count|\n+-------------------+--------------------+-----+\n|        West Region|Western Water Cat...|    1|\n|        West Region|       Bukit Panjang|    1|\n|       North Region|           Woodlands|   12|\n|  North-East Region|           Serangoon|    8|\n|       North Region|        Lim Chu Kang|    1|\n+-------------------+--------------------+-----+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=635","http://172.17.0.3:4040/jobs/job?id=636","http://172.17.0.3:4040/jobs/job?id=637","http://172.17.0.3:4040/jobs/job?id=638","http://172.17.0.3:4040/jobs/job?id=639","http://172.17.0.3:4040/jobs/job?id=640"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517305_1911207935","id":"20200106-145333_1998929540","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:43+0000","dateFinished":"2020-01-10T11:56:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4249"},{"text":"%pyspark\n\n# 3.ML on the Singapore Airbnb Data\n\nfrom pyspark.sql import SparkSession, Row, functions, types\nfrom pyspark.sql.functions import udf\nimport numpy as np\nimport pandas as pd\nfrom pandas import DataFrame\nfrom pyspark.ml.feature import HashingTF, IDF, Tokenizer, VectorAssembler, StringIndexer\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator\nfrom pyspark.mllib.regression import LabeledPoint\nfrom pyspark.ml.classification import NaiveBayes\nfrom pyspark.mllib.evaluation import MultilabelMetrics\nfrom pyspark.mllib.linalg import Vectors\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.tuning import CrossValidator, ParamGridBuilder\nfrom pyspark.mllib.evaluation import MulticlassMetrics, BinaryClassificationMetrics\nfrom pyspark.rdd import RDD\nfrom pyspark.sql.functions import col\nimport pandas as pd \nimport numpy as np \nfrom pyspark.sql import functions as F\nfrom pyspark.sql.functions import when\nfrom pyspark.sql import SparkSession\nfrom pyspark.ml.feature import VectorAssembler\nfrom pyspark.ml.classification import LogisticRegression\nfrom pyspark.mllib.evaluation import MulticlassMetrics\nfrom pyspark.sql import functions as F\nfrom pyspark.sql.functions import lit\nfrom datetime import date\nfrom pyspark.sql.types import StructField\nfrom pyspark.sql.types import StructType\nfrom pyspark.sql.types import *\nfrom pyspark.mllib.evaluation import MulticlassMetrics\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator\nfrom pyspark.mllib.evaluation import MultilabelMetrics\nfrom pyspark.mllib.evaluation import MulticlassMetrics, BinaryClassificationMetrics\nfrom pyspark.rdd import RDD\n","user":"anonymous","dateUpdated":"2020-01-10T11:56:45+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1578642517306_1465857164","id":"20200109-230226_1861914284","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:45+0000","dateFinished":"2020-01-10T11:56:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4251"},{"text":"%pyspark\n#3.Data Preprocessing\n#COlumns need tor the model tarining and make a new dataframe \nfeatures=['id','latitude','longitude','neighbourhood_group']\ndf_training = df.select(features)\n#df_training.show()\ndf_training = df_training.na.drop()\ndf_training = df_training.withColumn(\"longitude\", df_training[\"longitude\"].cast(DoubleType()))\ndf_training.printSchema()\n\ndf_training.createOrReplaceTempView(\"listings_view\")\n\ndf1_training = spark.sql(\"select  neighbourhood_group, count(id) id_count from listings_view group by neighbourhood_group order by id_count DESC\")\n#df1_training.show()\n#Ignore the neighbourhood group in which they have count less than 10\n\ndef valueToInt(value):\n    if value=='Central Region': return 1\n    elif value=='West Region': return  2\n    elif value=='East Region': return 3\n    elif value=='North-East Region': return 4\n    elif value=='North Region': return 5\n    else: return 6\n    \nudfValueToInt = udf(valueToInt, IntegerType())\ndf1_training = df_training.withColumn(\"label_column\", udfValueToInt(\"neighbourhood_group\"))\ndf2_training = df1_training.filter(df1_training['label_column'] < 6)\ndf2_training.show()\n","user":"anonymous","dateUpdated":"2020-01-10T11:56:45+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- id: string (nullable = true)\n |-- latitude: double (nullable = true)\n |-- longitude: double (nullable = true)\n |-- neighbourhood_group: string (nullable = true)\n\n+------+--------+---------+-------------------+------------+\n|    id|latitude|longitude|neighbourhood_group|label_column|\n+------+--------+---------+-------------------+------------+\n| 49091| 1.44255| 103.7958|       North Region|           5|\n| 50646| 1.33235|103.78521|     Central Region|           1|\n| 56334| 1.44246|103.79667|       North Region|           5|\n| 71609| 1.34541|103.95712|        East Region|           3|\n| 71896| 1.34567|103.95963|        East Region|           3|\n| 71903| 1.34702|103.96103|        East Region|           3|\n| 71907| 1.34348|103.96337|        East Region|           3|\n|241503| 1.32304|103.91363|        East Region|           3|\n|241508| 1.32458|103.91163|        East Region|           3|\n|241510| 1.32461|103.91191|        East Region|           3|\n|275343| 1.28875|103.80814|     Central Region|           1|\n|275344| 1.28837|103.81099|     Central Region|           1|\n|289234| 1.34561|103.95984|        East Region|           3|\n|294281| 1.31125|103.83816|     Central Region|           1|\n|324945| 1.28976|103.80896|     Central Region|           1|\n|330089| 1.28677|103.81244|     Central Region|           1|\n|330095| 1.28537|103.81087|     Central Region|           1|\n|344803| 1.34943|103.95951|        East Region|           3|\n|355955|  1.3142|103.90232|     Central Region|           1|\n|369141|  1.3115|103.83759|     Central Region|           1|\n+------+--------+---------+-------------------+------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=641"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517306_-1847834841","id":"20200109-231215_1083733324","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:45+0000","dateFinished":"2020-01-10T11:56:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4252"},{"text":"%pyspark\ndef vectAssembler(df,impFeatures):\n\tprint(\"Vector assembler \")\n\tassembler = VectorAssembler(inputCols=impFeatures,outputCol=\"features\")\n\tdf_new=assembler.transform(df)\n\tprint(\"vector assembling is done.\")\n\treturn df_new\nimpFeatures=['latitude','longitude']\nimpdf = df2_training.select(impFeatures).show()\n# Create a feature vector column using latitude and longitude \ndtf=vectAssembler(df2_training,impFeatures)\n\nfinalized_data = dtf.select('label_column', 'features')\nfrom pyspark.ml.feature import StandardScaler\nscaler = StandardScaler(inputCol='features', outputCol='scaledFeatures', withStd=True, withMean=True)\nscalerModel = scaler.fit(finalized_data)\nclassiFinalData = scalerModel.transform(finalized_data)\n\n# Splitting data into training and test sets (30% for testing)\n(trainingData, testData) = classiFinalData.randomSplit([0.7, 0.3])\n\ntrainingData.show()","user":"anonymous","dateUpdated":"2020-01-10T11:56:45+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+---------+\n|latitude|longitude|\n+--------+---------+\n| 1.44255| 103.7958|\n| 1.33235|103.78521|\n| 1.44246|103.79667|\n| 1.34541|103.95712|\n| 1.34567|103.95963|\n| 1.34702|103.96103|\n| 1.34348|103.96337|\n| 1.32304|103.91363|\n| 1.32458|103.91163|\n| 1.32461|103.91191|\n| 1.28875|103.80814|\n| 1.28837|103.81099|\n| 1.34561|103.95984|\n| 1.31125|103.83816|\n| 1.28976|103.80896|\n| 1.28677|103.81244|\n| 1.28537|103.81087|\n| 1.34943|103.95951|\n|  1.3142|103.90232|\n|  1.3115|103.83759|\n+--------+---------+\nonly showing top 20 rows\n\nVector assembler \nvector assembling is done.\n+------------+-------------------+--------------------+\n|label_column|           features|      scaledFeatures|\n+------------+-------------------+--------------------+\n|           1|[1.24387,103.84246]|[-2.3040593559511...|\n|           1|[1.24391,103.83915]|[-2.3027486080223...|\n|           1|[1.24853,103.82502]|[-2.1513572222400...|\n|           1|[1.24881,103.82364]|[-2.1421819867381...|\n|           1|[1.24918,103.82509]|[-2.1300575683962...|\n|           1|[1.24992,103.82441]|[-2.1058087317125...|\n|           1| [1.2504,103.82539]|[-2.0900797565663...|\n|           1|[1.25046,103.82529]|[-2.0881136346730...|\n|           1|[1.25054,103.82551]|[-2.0854921388153...|\n|           1|[1.25088,103.82482]|[-2.0743507814200...|\n|           1|[1.25284,103.82225]|[-2.0101241329064...|\n|           1|[1.25306,103.82268]|[-2.0029150192977...|\n|           1|  [1.25602,103.821]|[-1.9059196725627...|\n|           1|[1.25639,103.82302]|[-1.8937952542209...|\n|           1|[1.26478,103.81762]|[-1.6188658761444...|\n|           1| [1.26504,103.8146]|[-1.6103460146069...|\n|           1|[1.26513,103.81722]|[-1.6073968317669...|\n|           1|[1.26569,103.81606]|[-1.5890463607630...|\n|           1|[1.26582,103.81531]|[-1.5847864299943...|\n|           1|[1.26603,103.81693]|[-1.5779050033678...|\n+------------+-------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=642","http://172.17.0.3:4040/jobs/job?id=643","http://172.17.0.3:4040/jobs/job?id=644"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517307_-1869349298","id":"20200109-232139_209855726","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:45+0000","dateFinished":"2020-01-10T11:56:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4253"},{"text":"%pyspark\ndef LRTraining(trainDF):\n\tprint(\"Model fitting started\")\n\tlr = LogisticRegression(labelCol=\"label_column\", featuresCol=\"scaledFeatures\",elasticNetParam=0.8, family=\"multinomial\",maxIter=120)\n\tmodel=lr.fit(trainDF)\n\tprint(\"Model fitting completed\")\n\treturn model \n\t\nmodel = LRTraining(trainingData)\n\n# Get predictions.\npredictions = model.transform(testData)\n\n# Predicted data \npredictions.select(\"prediction\", \"label_column\", \"features\").show(5)","user":"anonymous","dateUpdated":"2020-01-10T11:56:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Model fitting started\nModel fitting completed\n+----------+------------+-------------------+\n|prediction|label_column|           features|\n+----------+------------+-------------------+\n|       1.0|           1|[1.24526,103.83999]|\n|       1.0|           1|[1.24847,103.82389]|\n|       1.0|           1|[1.26649,103.81585]|\n|       1.0|           1|[1.26675,103.81219]|\n|       1.0|           1|[1.26713,103.81156]|\n+----------+------------+-------------------+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=645","http://172.17.0.3:4040/jobs/job?id=646","http://172.17.0.3:4040/jobs/job?id=647","http://172.17.0.3:4040/jobs/job?id=648","http://172.17.0.3:4040/jobs/job?id=649","http://172.17.0.3:4040/jobs/job?id=650","http://172.17.0.3:4040/jobs/job?id=651","http://172.17.0.3:4040/jobs/job?id=652","http://172.17.0.3:4040/jobs/job?id=653","http://172.17.0.3:4040/jobs/job?id=654","http://172.17.0.3:4040/jobs/job?id=655","http://172.17.0.3:4040/jobs/job?id=656","http://172.17.0.3:4040/jobs/job?id=657","http://172.17.0.3:4040/jobs/job?id=658","http://172.17.0.3:4040/jobs/job?id=659","http://172.17.0.3:4040/jobs/job?id=660","http://172.17.0.3:4040/jobs/job?id=661","http://172.17.0.3:4040/jobs/job?id=662","http://172.17.0.3:4040/jobs/job?id=663","http://172.17.0.3:4040/jobs/job?id=664","http://172.17.0.3:4040/jobs/job?id=665","http://172.17.0.3:4040/jobs/job?id=666","http://172.17.0.3:4040/jobs/job?id=667","http://172.17.0.3:4040/jobs/job?id=668","http://172.17.0.3:4040/jobs/job?id=669","http://172.17.0.3:4040/jobs/job?id=670","http://172.17.0.3:4040/jobs/job?id=671","http://172.17.0.3:4040/jobs/job?id=672","http://172.17.0.3:4040/jobs/job?id=673","http://172.17.0.3:4040/jobs/job?id=674","http://172.17.0.3:4040/jobs/job?id=675","http://172.17.0.3:4040/jobs/job?id=676","http://172.17.0.3:4040/jobs/job?id=677","http://172.17.0.3:4040/jobs/job?id=678","http://172.17.0.3:4040/jobs/job?id=679","http://172.17.0.3:4040/jobs/job?id=680","http://172.17.0.3:4040/jobs/job?id=681","http://172.17.0.3:4040/jobs/job?id=682","http://172.17.0.3:4040/jobs/job?id=683","http://172.17.0.3:4040/jobs/job?id=684","http://172.17.0.3:4040/jobs/job?id=685","http://172.17.0.3:4040/jobs/job?id=686","http://172.17.0.3:4040/jobs/job?id=687","http://172.17.0.3:4040/jobs/job?id=688","http://172.17.0.3:4040/jobs/job?id=689","http://172.17.0.3:4040/jobs/job?id=690","http://172.17.0.3:4040/jobs/job?id=691","http://172.17.0.3:4040/jobs/job?id=692","http://172.17.0.3:4040/jobs/job?id=693","http://172.17.0.3:4040/jobs/job?id=694","http://172.17.0.3:4040/jobs/job?id=695","http://172.17.0.3:4040/jobs/job?id=696","http://172.17.0.3:4040/jobs/job?id=697","http://172.17.0.3:4040/jobs/job?id=698","http://172.17.0.3:4040/jobs/job?id=699","http://172.17.0.3:4040/jobs/job?id=700","http://172.17.0.3:4040/jobs/job?id=701","http://172.17.0.3:4040/jobs/job?id=702","http://172.17.0.3:4040/jobs/job?id=703","http://172.17.0.3:4040/jobs/job?id=704","http://172.17.0.3:4040/jobs/job?id=705","http://172.17.0.3:4040/jobs/job?id=706","http://172.17.0.3:4040/jobs/job?id=707","http://172.17.0.3:4040/jobs/job?id=708","http://172.17.0.3:4040/jobs/job?id=709","http://172.17.0.3:4040/jobs/job?id=710","http://172.17.0.3:4040/jobs/job?id=711","http://172.17.0.3:4040/jobs/job?id=712","http://172.17.0.3:4040/jobs/job?id=713","http://172.17.0.3:4040/jobs/job?id=714","http://172.17.0.3:4040/jobs/job?id=715","http://172.17.0.3:4040/jobs/job?id=716","http://172.17.0.3:4040/jobs/job?id=717","http://172.17.0.3:4040/jobs/job?id=718","http://172.17.0.3:4040/jobs/job?id=719","http://172.17.0.3:4040/jobs/job?id=720","http://172.17.0.3:4040/jobs/job?id=721","http://172.17.0.3:4040/jobs/job?id=722","http://172.17.0.3:4040/jobs/job?id=723","http://172.17.0.3:4040/jobs/job?id=724","http://172.17.0.3:4040/jobs/job?id=725","http://172.17.0.3:4040/jobs/job?id=726","http://172.17.0.3:4040/jobs/job?id=727","http://172.17.0.3:4040/jobs/job?id=728","http://172.17.0.3:4040/jobs/job?id=729","http://172.17.0.3:4040/jobs/job?id=730","http://172.17.0.3:4040/jobs/job?id=731","http://172.17.0.3:4040/jobs/job?id=732","http://172.17.0.3:4040/jobs/job?id=733","http://172.17.0.3:4040/jobs/job?id=734","http://172.17.0.3:4040/jobs/job?id=735","http://172.17.0.3:4040/jobs/job?id=736","http://172.17.0.3:4040/jobs/job?id=737"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517307_1365700946","id":"20200109-232615_603876800","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:46+0000","dateFinished":"2020-01-10T11:56:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4254"},{"text":"%pyspark\nfrom pyspark.mllib.evaluation import MulticlassMetrics\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator\nfrom pyspark.mllib.evaluation import MultilabelMetrics\nfrom pyspark.mllib.evaluation import MulticlassMetrics, BinaryClassificationMetrics\nfrom pyspark.rdd import RDD\n\nevaluatorRecall = MulticlassClassificationEvaluator(labelCol=\"label_column\", predictionCol=\"prediction\", metricName=\"weightedRecall\")\nevaluatorPrecision = MulticlassClassificationEvaluator(labelCol=\"label_column\", predictionCol=\"prediction\", metricName=\"weightedPrecision\")\nrecall = evaluatorRecall.evaluate(predictions)\nprecision = evaluatorPrecision.evaluate(predictions)\nprint(\"Recall %s\" % recall)\nprint(\"Precision %s\" % precision)","user":"anonymous","dateUpdated":"2020-01-10T11:56:48+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Recall 0.983160621762\nPrecision 0.983975009575\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=738","http://172.17.0.3:4040/jobs/job?id=739","http://172.17.0.3:4040/jobs/job?id=740","http://172.17.0.3:4040/jobs/job?id=741","http://172.17.0.3:4040/jobs/job?id=742"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517308_1427298834","id":"20200109-232850_1711920911","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:48+0000","dateFinished":"2020-01-10T11:56:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4255"},{"text":"%pyspark\n\n#4. Presentation of the analysis for Singapore Airbnb Data\n#1.  Total number of rentals that are available 365 days a year, and the total number of rentals.(As numbers)\ndf_tot_rental=spark.sql(\"select count(*)totalrentals from  listing_temp_tbl \")\ndf_tot_rental.show()\ndf_df_tot_rental_av_365=spark.sql(\"select count(*)totalrentals_ava_365 from  listing_temp_tbl where availability_365=365 \")\ndf_df_tot_rental_av_365.show()\n\n","user":"anonymous","dateUpdated":"2020-01-10T11:56:49+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+\n|totalrentals|\n+------------+\n|        7921|\n+------------+\n\n+--------------------+\n|totalrentals_ava_365|\n+--------------------+\n|                 843|\n+--------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=743","http://172.17.0.3:4040/jobs/job?id=744"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517308_-185218320","id":"20200106-164607_476645118","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:49+0000","dateFinished":"2020-01-10T11:56:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4256"},{"text":"%pyspark\n#2.  Number of rentals per neighbourhood_group (As a bar chart)\n\ndf_rentalsperneighbourhd=spark.sql(\"select neighbourhood_group,count(*)count  from  listing_temp_tbl group by neighbourhood_group  order by count desc limit 5\")\ndf_rentalsperneighbourhd.show()\n\nhistogramdfpandas = df_rentalsperneighbourhd.toPandas()\nhistPlot = histogramdfpandas.plot.bar(x='neighbourhood_group', y='count', color='b')","user":"anonymous","dateUpdated":"2020-01-10T11:56:49+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+-----+\n|neighbourhood_group|count|\n+-------------------+-----+\n|     Central Region| 6301|\n|        West Region|  539|\n|        East Region|  508|\n|  North-East Region|  344|\n|       North Region|  203|\n+-------------------+-----+\n\n<matplotlib.figure.Figure at 0x7fcd0c2e2b10>\n"},{"type":"IMG","data":"iVBORw0KGgoAAAANSUhEUgAAAYAAAAFbCAYAAADcPllTAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMS4xLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvAOZPmwAAIABJREFUeJzt3XmcXFWd9/HPlyQQTIAQEhASMKgoi4bFln1kyWNYFEEERLaAGfL4DAqKjoKzMG4zgiMiOoJBloA4EFEE0REzBHHY6QACATEZ2dogCSQEEFkCv+ePe5quNNWp6qSpU53zfb9e9ap7T926/bs3lfrVPfcsigjMzKw8a+QOwMzM8nACMDMrlBOAmVmhnADMzArlBGBmVignADOzQjkBmJkVygnAzKxQTgBmZoUamjuAFRkzZkxMmDAhdxhmZoPKnDlznoyIsY22a+sEMGHCBDo7O3OHYWY2qEh6pJntXAVkZlYoJwAzs0I5AZiZFaqt7wGYmTXy8ssv09XVxQsvvJA7lJYbPnw448ePZ9iwYSv1ficAMxvUurq6WGeddZgwYQKScofTMhHBU089RVdXF5tvvvlK7cNVQGY2qL3wwgtssMEGRX35A0higw02WKUrHycAMxv0Svvy77aqx+0EYGZWqNU+AUjt8TCz1lgd/++eddZZPP/88wO+39U+AZiZDXZOAGZmbeziiy9m4sSJbLvtthx99NE88sgjTJo0iYkTJzJp0iQeffRRAI499liuuOKK1943cuRIAH7zm9+w5557csghh7Dlllty5JFHEhGcffbZLFiwgL322ou99tprQGN2M1Azs1U0d+5cvva1r3HTTTcxZswYFi9ezJQpUzjmmGOYMmUKF1xwASeeeCI/+9nPVrifu+66i7lz57LJJpuw2267cdNNN3HiiSdy5plncv311zNmzJgBjdtXAGZmq2j27Nkccsghr31Bjx49mltuuYUjjjgCgKOPPpobb7yx4X523HFHxo8fzxprrMF2223Hww8//EaG7QRgZraqIqJhk8zu14cOHcqrr7762vteeuml17ZZa621XlseMmQIy5YtewOi7eEEYGa2iiZNmsTMmTN56qmnAFi8eDG77rorl112GQCXXnopu+++O1ANcz9nzhwArrrqKl5++eWG+19nnXV49tlnBzzuphKApFGS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\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=745","http://172.17.0.3:4040/jobs/job?id=746"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517309_1346583329","id":"20200109-233357_954801382","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:49+0000","dateFinished":"2020-01-10T11:56:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4257"},{"text":"%pyspark\n#3 Average price of private room by neighbourhood group.\ndf_avgpricebyneibourgoodgroup=spark.sql(\"select neighbourhood_group,avg(cast(price as float))avg_price  from  listing_temp_tbl where room_type = 'Private room' group by neighbourhood_group  order by avg_price desc limit 5\")\ndf_avgpricebyneibourgoodgroup.show()\nhistogramdfpandas = df_avgpricebyneibourgoodgroup.toPandas()\nhistPlot = histogramdfpandas.plot.bar(x='neighbourhood_group', y='avg_price', color='g')\n","user":"anonymous","dateUpdated":"2020-01-10T11:56:51+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+------------------+\n|neighbourhood_group|         avg_price|\n+-------------------+------------------+\n|        West Region|117.82539682539682|\n|        East Region|117.23497267759562|\n|     Central Region|114.47408742676882|\n|       North Region| 82.35460992907801|\n|  North-East Region| 80.06296296296296|\n+-------------------+------------------+\n\n<matplotlib.figure.Figure at 0x7fcd0c6b41d0>\n"},{"type":"IMG","data":"iVBORw0KGgoAAAANSUhEUgAAAXoAAAFbCAYAAADbUEUDAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMS4xLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvAOZPmwAAIABJREFUeJzt3XucXuO99/HPV0RzIoKhJAhtiFNUDE3EoykPW1vH1CmljcOWenba0sOmeqJb7b2DqqqiUYTWIanDpuzdIqR2EPYEFYLKpmpKCSIRkRJ+zx9rTebOZDKne2aumbW+79drXnOv6z79ZiXznXVf61rXpYjAzMyKa53UBZiZWddy0JuZFZyD3sys4Bz0ZmYF56A3Mys4B72ZWcE56M3MCs5Bb2ZWcA56M7OCWzd1AQCbbLJJDB8+PHUZZma9yrx5816PiJrWHtcjgn748OHU1dWlLsPMrFeR9GJbHueuGzOzgms16CVdJek1SU9WtJ0v6RlJT0i6VdKGFfedKWmhpGcl/UNXFW5mZm3TliP66cCBTdruBnaOiFHAn4AzASTtCBwD7JQ/51JJfTqtWjMza7dW++gj4n5Jw5u03VWxORc4Ir99KHBjRPwdeEHSQmBP4KFOqdbMeo3333+f+vp6VqxYkbqUXq9fv34MGzaMvn37duj5nXEy9kRgRn57KFnwN6jP29YgaTIwGWCrrbbqhDLMrCepr69n/fXXZ/jw4UhKXU6vFRG88cYb1NfXs80223ToNao6GSvpu8BK4LqGpmYe1uzKJhExLSJqI6K2pqbV0UFm1susWLGCjTfe2CFfJUlsvPHGVX0y6vARvaRJwEHAftG4TFU9sGXFw4YBL3e4OjPr1RzynaPa/dihI3pJBwJnAIdExPKKu24HjpH0EUnbACOAR6qq0MzMqtLqEb2kG4DxwCaS6oGzyEbZfAS4O/9LMzciTomIpyTNBBaQdelMiYgPuqr41er8YfojhzjL6++arU1n/476963t2jLqZmIzzVe28PhzgXOrKcqq4z96Zj1DXV0d1157LRdffHHSOnrEFAhmZkWzcuVKamtrqa2tTV2Kp0Aws+I67LDD2H333dlpp52YNm0al112Gaeffvqq+6dPn85Xv/pVAM455xxGjhzJ/vvvz8SJE7ngggvW+rrjx4/ntNNOY6+99mLnnXfmkUeyU5Fnn302kydP5oADDuBLX/oSs2fP5qCDDgJg2bJlnHDCCeyyyy6MGjWKm2++GYC77rqLsWPHMnr0aI488kiWLVvW6fvBR/RmVlhXXXUVG220Ee+++y577LEHs2bNYty4cZx33nkAzJgxg+9+97vU1dVx880389hjj7Fy5UpGjx7N7rvv3uJrv/POOzz44IPcf//9nHjiiTz5ZDZLzLx585gzZw79+/dn9uzZqx5/zjnnMHjwYObPnw/A4sWLef311/nRj37EPffcw8CBA5k6dSoXXnghP/jBDzp1PzjozaywLr74Ym699VYAXnrpJV544QW23XZb5s6dy4gRI3j22WcZN24cP/3pTzn00EPp378/AAcffHCrrz1xYnb6cp999mHp0qW89dZbABxyyCGrXqfSPffcw4033rhqe8iQIdxxxx0sWLCAcePGAfDee+8xduzY6n7oZjjordB8Yrq8Zs+ezT333MNDDz3EgAEDGD9+PCtWrODoo49m5syZjBw5ksMPPxxJNF4K1HZNx7Y3bA8cOLDZx0fEGs+JCPbff39uuOGGdr9/ezjozaxbdPcfvCVLljBkyBAGDBjAM888w9y52ewsEyZM4Nxzz2Xrrbdm6tSpAOy99958+ctf5swzz2TlypXceeednHzyyS2+/owZM/j0pz/NnDlzGDx4MIMHD27x8QcccACXXHIJF110EZB13YwZM4YpU6awcOFCPv7xj7N8+XLq6+vZbrvtOmEPNPLJWDMrpAMPPJCVK1cyatQovv/97zNmzBgg6zLZcccdefHFF9lzzz0B2GOPPTjkkEPYddddmTBhArW1ta0G95AhQ9hrr7045ZRTuPLKtY44X+V73/seixcvZuedd2bXXXflvvvuo6amhunTpzNx4kRGjRrFmDFjeOaZZ6r/4ZtQRz6ydLba2tqodoUpf0Rv5H3RyPsinaeffpoddtghdRlttmzZMgYNGsTy5cvZZ599mDZtGqNHj272sePHj+eCCy7o1qGTze1PSfMiotUi3HVjZgZMnjyZBQsWsGLFCiZNmrTWkO+NHPRmZsD111+/RtuUKVN44IEHVms79dRTVxs22Rs46M2syzQ30qQ3+fnPf566BIAOjQqq5JOxZtYl+vXrxxtvvFF1SJVdw8Ij/fr16/Br+IjezLrEsGHDqK+vZ9GiRalL6fUalhLs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\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=747","http://172.17.0.3:4040/jobs/job?id=748"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517309_276422112","id":"20200109-234039_2098287032","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:51+0000","dateFinished":"2020-01-10T11:56:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4258"},{"text":"%pyspark\n\n#4 Top 10 neighbourhood based on Average price of Private room\ndf_avgpricebyneibourhood=spark.sql(\"select neighbourhood_group, neighbourhood,avg(cast(price as float))avg_price  from  listing_temp_tbl where room_type = 'Private room' group by neighbourhood_group,neighbourhood  order by avg_price desc limit 10\")\ndf_avgpricebyneibourhood.show()\n","user":"anonymous","dateUpdated":"2020-01-10T11:56:52+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+----------------+------------------+\n|neighbourhood_group|   neighbourhood|         avg_price|\n+-------------------+----------------+------------------+\n|     Central Region|Southern Islands| 649.6666666666666|\n|     Central Region|    Marina South|             419.0|\n|        West Region|   Bukit Panjang|409.44827586206895|\n|        West Region|     Jurong East|182.25757575757575|\n|     Central Region|   Downtown Core| 163.5047619047619|\n|     Central Region| Singapore River|150.66666666666666|\n|     Central Region|         Orchard|146.89795918367346|\n|     Central Region|       Toa Payoh|            142.78|\n|     Central Region|          Bishan|138.92105263157896|\n|     Central Region|          Outram|135.26639344262296|\n+-------------------+----------------+------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=749"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517309_-1196505827","id":"20200109-234724_1842709463","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:52+0000","dateFinished":"2020-01-10T11:56:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4259"},{"text":"%pyspark\n# 5 lowest price per each room type \ndf_avgpricebyneibourhood=spark.sql(\"select neighbourhood_group, neighbourhood,price  from  listing_temp_tbl where room_type = 'Private room' order by price asc limit 5\")\ndf_avgpricebyneibourhood.show()\ndf_avgpricebyneibourhood=spark.sql(\"select neighbourhood_group, neighbourhood,price  from  listing_temp_tbl where room_type = 'Shared room' order by price asc limit 5\")\ndf_avgpricebyneibourhood.show()\ndf_avgpricebyneibourhood=spark.sql(\"select neighbourhood_group, neighbourhood,price  from  listing_temp_tbl where room_type = 'Entire home/apt' order by price asc limit 5\")\ndf_avgpricebyneibourhood.show()","user":"anonymous","dateUpdated":"2020-01-10T11:56:53+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":508,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+-------------+-----+\n|neighbourhood_group|neighbourhood|price|\n+-------------------+-------------+-----+\n|     Central Region|Marine Parade|   14|\n|     Central Region|      Geylang|   15|\n|     Central Region|       Outram|   15|\n|        East Region|     Tampines|   15|\n|        West Region|  Jurong West|   15|\n+-------------------+-------------+-----+\n\n+-------------------+-------------+-----+\n|neighbourhood_group|neighbourhood|price|\n+-------------------+-------------+-----+\n|        East Region|        Bedok|   14|\n|        West Region|  Jurong West|   15|\n|     Central Region|      Kallang|   18|\n|     Central Region|       Rochor|   18|\n|     Central Region|      Kallang|   19|\n+-------------------+-------------+-----+\n\n+-------------------+-------------+-----+\n|neighbourhood_group|neighbourhood|price|\n+-------------------+-------------+-----+\n|     Central Region|       Rochor|    0|\n|     Central Region|      Geylang|   14|\n|        West Region|Bukit Panjang|   14|\n|     Central Region|  Bukit Timah|   31|\n|       North Region|       Yishun|   39|\n+-------------------+-------------+-----+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=750","http://172.17.0.3:4040/jobs/job?id=751","http://172.17.0.3:4040/jobs/job?id=752"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517310_-104801975","id":"20200106-172332_1291313128","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:53+0000","dateFinished":"2020-01-10T11:56:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4260"},{"text":"%pyspark\nimport matplotlib.pyplot as plt\n#Percentage of owners who rent more than one property\n\n# Getting the count of total number of owners \nowners = spark.sql(\"select host_id, host_name, COUNT(*) as Properties from listing_temp_tbl group by host_id, host_name Order by Properties DESC\")\n#print(owners.show())\n##Get the owners count\nOwnersCount=owners.count()\n\n\n# Getting the count of total number of multiple property owners \nownersgtone = spark.sql(\"select host_id, host_name, COUNT(*) as Properties from listing_temp_tbl group by host_id, host_name HAVING Properties>1 Order by Properties DESC\")\nownersgtone_1=ownersgtone.count()\npercentageOfMultipleOwners = (float(ownersgtone_1)/OwnersCount)*100.0\nprint(\"###########Percentage of owners who rent more than one property##################\")\nprint(percentageOfMultipleOwners)\n\n\n# Data to plot\nlabels = 'Multiple Properties', 'One Property'\nsizes = [percentageOfMultipleOwners, 100-percentageOfMultipleOwners, ]\ncolors = ['gold', 'yellowgreen']\nexplode = (0.1, 0)  # explode 1st slice\n\n# Plot\nplt.pie(sizes, explode=explode, labels=labels, colors=colors,\nautopct='%1.1f%%', shadow=True, startangle=140)\n\nplt.axis('equal')\nplt.show()","user":"anonymous","dateUpdated":"2020-01-10T11:56:53+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=753","http://172.17.0.3:4040/jobs/job?id=754","http://172.17.0.3:4040/jobs/job?id=755","http://172.17.0.3:4040/jobs/job?id=756"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517310_-451615171","id":"20200109-235852_14939391","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:53+0000","dateFinished":"2020-01-10T11:56:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4261","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"###########Percentage of owners who rent more than one property##################\n27.3163528977\n<matplotlib.figure.Figure at 0x7fcd0c2ca910>\n"},{"type":"IMG","data":"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\n"}]}},{"text":"%pyspark\nimport pandas as pd \nfrom pyspark.sql.functions import *\nhistogramdf = spark.sql(\"Select month(last_review)month  ,count(*)as sum from listing_temp_tbl where month(last_review) is not null group by month order by month\")\nprint(histogramdf.show())\n\nhistogramdfpandas = histogramdf.toPandas()\nhistPlot = histogramdfpandas.plot.bar(x='month', y='sum', color='orange')\n","user":"anonymous","dateUpdated":"2020-01-10T11:56:56+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"tableHide":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+----+\n|month| sum|\n+-----+----+\n|    1| 241|\n|    2| 236|\n|    3| 235|\n|    4| 249|\n|    5| 334|\n|    6| 455|\n|    7| 983|\n|    8|1822|\n|    9| 149|\n|   10| 125|\n|   11| 111|\n|   12| 201|\n+-----+----+\n\nNone\n\n"},{"type":"IMG","data":"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\n\n"},{"type":"TEXT","data":"<matplotlib.figure.Figure at 0x7fcd05ee2bd0>"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=757","http://172.17.0.3:4040/jobs/job?id=758","http://172.17.0.3:4040/jobs/job?id=759"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578642517311_596547119","id":"20200110-000723_185567494","dateCreated":"2020-01-10T07:48:37+0000","dateStarted":"2020-01-10T11:56:56+0000","dateFinished":"2020-01-10T11:56:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4262"},{"text":"%pyspark\ntop5Arentals = spark.sql(\"Select * from listing_temp_tbl  where  cast(availability_365 as string)like '%365%'\")\ntop5Arentals.createOrReplaceTempView(\"listingtemptable_365\")\ndf1=spark.sql(\" select * from listingtemptable_365 \")\n#df1.show()\ntop5Arentals1 = spark.sql(\"Select neighbourhood_group, neighbourhood, count(*) as count from listingtemptable_365 where neighbourhood in (Select neighbourhood  From listingtemptable_365 Group By neighbourhood_group, neighbourhood  order By avg(price) Limit 5)  group by neighbourhood_group, neighbourhood\")\n\ntop5Arentals1.show()\n\n","user":"anonymous","dateUpdated":"2020-01-10T11:56:57+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+--------------------+-----+\n|neighbourhood_group|       neighbourhood|count|\n+-------------------+--------------------+-----+\n|        West Region|Western Water Cat...|    1|\n|        West Region|       Bukit Panjang|    1|\n|       North Region|           Woodlands|   12|\n|  North-East Region|           Serangoon|    8|\n|       North Region|        Lim Chu Kang|    1|\n+-------------------+--------------------+-----+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.3:4040/jobs/job?id=760","http://172.17.0.3:4040/jobs/job?id=761","http://172.17.0.3:4040/jobs/job?id=762","http://172.17.0.3:4040/jobs/job?id=763","http://172.17.0.3:4040/jobs/job?id=764","http://172.17.0.3:4040/jobs/job?id=765"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578652760298_1344402124","id":"20200110-103920_1075249585","dateCreated":"2020-01-10T10:39:20+0000","dateStarted":"2020-01-10T11:56:57+0000","dateFinished":"2020-01-10T11:56:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4263"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-01-10T11:19:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578652937720_-1791348719","id":"20200110-104217_1548641679","dateCreated":"2020-01-10T10:42:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4264"}],"name":"2019004_spark","id":"2EYTBNDP5","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}